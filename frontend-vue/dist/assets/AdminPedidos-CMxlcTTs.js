import{_ as e,j as t,d as a,p as s,c as o,o as r,a as l,b as d,u as n,x as i,l as c,v as u,t as p,F as g,g as m,f as v,n as x,z as y}from"./index-klLf_Ke9.js";import{a as f}from"./adminService-JkG_pKWo.js";const h={class:"space-y-6"},b={class:"flex justify-between items-center"},w={class:"flex items-center space-x-4"},k={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},C={class:"bg-white rounded-lg shadow p-4"},E={class:"text-center"},P={class:"text-2xl font-bold text-yellow-600"},j={class:"bg-white rounded-lg shadow p-4"},R={class:"text-center"},S={class:"text-2xl font-bold text-blue-600"},z={class:"bg-white rounded-lg shadow p-4"},D={class:"text-center"},$={class:"text-2xl font-bold text-purple-600"},I={class:"bg-white rounded-lg shadow p-4"},A={class:"text-center"},O={class:"text-2xl font-bold text-green-600"},B={class:"bg-white rounded-lg shadow p-4"},L={class:"text-center"},T={class:"text-2xl font-bold text-red-600"},M={class:"bg-white rounded-lg shadow overflow-hidden"},q={class:"overflow-x-auto"},N={class:"min-w-full divide-y divide-gray-200"},V={class:"bg-white divide-y divide-gray-200"},_={class:"px-6 py-4 whitespace-nowrap"},F={class:"text-sm font-medium text-gray-900"},U={class:"text-sm text-gray-500"},G={class:"px-6 py-4 whitespace-nowrap"},J={class:"text-sm font-medium text-gray-900"},Q={class:"text-sm text-gray-500"},H={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},K={class:"px-6 py-4 whitespace-nowrap"},W=["value","onChange"],X={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Y={class:"px-6 py-4 whitespace-nowrap"},Z={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},ee=["onClick"],te=["onClick"],ae={key:0,class:"text-center py-8 text-gray-500"},se={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},oe={class:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto"},re={class:"px-6 py-4 border-b"},le={class:"flex justify-between items-center"},de={class:"text-lg font-semibold text-gray-900"},ne={class:"p-6 space-y-6"},ie={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ce={class:"space-y-1 text-sm"},ue={class:"space-y-1 text-sm"},pe={class:"space-y-3"},ge={class:"flex items-center space-x-3"},me=["src","alt"],ve={class:"font-medium"},xe={class:"text-sm text-gray-600"},ye={class:"font-medium"},fe={class:"mt-4 pt-4 border-t"},he={class:"flex justify-between text-lg font-semibold"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},we={class:"space-y-1 text-sm"},ke={key:0},Ce={class:"space-y-1 text-sm"},Ee={key:0},Pe={class:"flex justify-end space-x-3 pt-4 border-t"},je={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Re={class:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},Se={class:"space-y-4"},ze={class:"flex justify-end space-x-3"},De=e({__name:"AdminPedidos",setup(e){const{showNotification:De}=y(),$e=t([]),Ie=t([]),Ae=t(null),Oe=t(!1),Be=t(null),Le=t(""),Te=t(""),Me=t(""),qe=t(!1),Ne=a(()=>{const e={pending:0,processing:0,shipped:0,delivered:0,cancelled:0};return $e.value.forEach(t=>{switch(t.status){case"pending":e.pending++;break;case"processing":e.processing++;break;case"shipped":e.shipped++;break;case"delivered":e.delivered++;break;case"cancelled":e.cancelled++}}),e}),Ve=async()=>{try{qe.value=!0;const e=await f.getOrders();$e.value=e.data.data||e.data,_e()}catch(e){console.error("Erro ao carregar pedidos:",e),De("Erro ao carregar pedidos","error")}finally{qe.value=!1}},_e=()=>{let e=$e.value;if(Te.value&&(e=e.filter(e=>e.status===Te.value)),Me.value){const t=Me.value.toLowerCase();e=e.filter(e=>e.id.toLowerCase().includes(t)||e.customer.name.toLowerCase().includes(t)||e.customer.email.toLowerCase().includes(t))}Ie.value=e},Fe=async()=>{try{const e=$e.value.find(e=>e.id===Be.value);e&&(e.trackingCode=Le.value,De("C贸digo de rastreamento adicionado com sucesso!","success")),Oe.value=!1,Le.value="",Be.value=null}catch(e){console.error("Erro ao salvar rastreamento:",e),De("Erro ao salvar c贸digo de rastreamento","error")}},Ue=e=>new Intl.NumberFormat("pt-BR",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),Ge=e=>({Aprovado:"bg-green-100 text-green-800",Pendente:"bg-yellow-100 text-yellow-800",Pago:"bg-green-100 text-green-800",Recusado:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800"),Je=()=>{try{const e=Ie.value.map(e=>({id:e.id,cliente:e.customer.name,email:e.customer.email,telefone:e.customer.phone,valor:e.total,status:e.status,data:e.createdAt,pagamento:{metodo:e.payment.method,status:e.payment.status},entrega:{metodo:e.shipping.method,endereco:e.shipping.address,cidade:e.shipping.city,estado:e.shipping.state,cep:e.shipping.zipCode},rastreamento:e.trackingCode,itens:e.items.map(e=>({nome:e.name,quantidade:e.quantity,preco:e.price}))})),t={dataGeracao:(new Date).toLocaleString("pt-BR"),totalPedidos:e.length,filtroStatus:Te.value||"Todos",pedidos:e},a=JSON.stringify(t,null,2),s="data:application/json;charset=utf-8,"+encodeURIComponent(a),o=`pedidos-${Te.value||"todos"}-${(new Date).toISOString().split("T")[0]}.json`,r=document.createElement("a");r.setAttribute("href",s),r.setAttribute("download",o),r.click(),De(`${e.length} pedidos exportados com sucesso!`,"success")}catch(e){console.error("Erro ao exportar pedidos:",e),De("Erro ao exportar pedidos","error")}};return s(()=>{Ve()}),(e,t)=>(r(),o("div",h,[l("div",b,[t[9]||(t[9]=l("h1",{class:"text-2xl font-bold text-gray-900"},"Gerenciar Pedidos",-1)),l("div",w,[n(l("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>Te.value=e),onChange:_e,class:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[...t[8]||(t[8]=[c('<option value="" data-v-d275affd>Todos os Status</option><option value="Pendente" data-v-d275affd>Pendente</option><option value="Processando" data-v-d275affd>Processando</option><option value="Enviado" data-v-d275affd>Enviado</option><option value="Entregue" data-v-d275affd>Entregue</option><option value="Cancelado" data-v-d275affd>Cancelado</option>',6)])],544),[[i,Te.value]]),n(l("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>Me.value=e),onInput:_e,type:"text",placeholder:"Buscar por ID, cliente...",class:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,544),[[u,Me.value]]),l("button",{onClick:Je,class:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition ml-2"},"  Exportar Pedidos ")])]),l("div",k,[l("div",C,[l("div",E,[l("div",P,p(Ne.value.pending),1),t[10]||(t[10]=l("p",{class:"text-sm text-gray-600"},"Pendentes",-1))])]),l("div",j,[l("div",R,[l("div",S,p(Ne.value.processing),1),t[11]||(t[11]=l("p",{class:"text-sm text-gray-600"},"Processando",-1))])]),l("div",z,[l("div",D,[l("div",$,p(Ne.value.shipped),1),t[12]||(t[12]=l("p",{class:"text-sm text-gray-600"},"Enviados",-1))])]),l("div",I,[l("div",A,[l("div",O,p(Ne.value.delivered),1),t[13]||(t[13]=l("p",{class:"text-sm text-gray-600"},"Entregues",-1))])]),l("div",B,[l("div",L,[l("div",T,p(Ne.value.cancelled),1),t[14]||(t[14]=l("p",{class:"text-sm text-gray-600"},"Cancelados",-1))])])]),l("div",M,[l("div",q,[l("table",N,[t[16]||(t[16]=l("thead",{class:"bg-gray-50"},[l("tr",null,[l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Pedido "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Valor "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Data "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Pagamento "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," A莽玫es ")])],-1)),l("tbody",V,[(r(!0),o(g,null,m(Ie.value,e=>{return r(),o("tr",{key:e.id,class:"hover:bg-gray-50"},[l("td",_,[l("div",F," #"+p(e.id),1),l("div",U,p(e.items.length)+" item(ns) ",1)]),l("td",G,[l("div",J,p(e.customer.name),1),l("div",Q,p(e.customer.email),1)]),l("td",H," R$ "+p(Ue(e.total)),1),l("td",K,[l("select",{value:e.status,onChange:t=>(async(e,t)=>{try{await f.updateOrder(e,{status:t}),await Ve(),De(`Status do pedido #${e} atualizado para ${t}`,"success")}catch(a){console.error("Erro ao atualizar status:",a),De("Erro ao atualizar status do pedido","error")}})(e.id,t.target.value),class:"text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[...t[15]||(t[15]=[c('<option value="Pendente" data-v-d275affd>Pendente</option><option value="Processando" data-v-d275affd> Processando </option><option value="Enviado" data-v-d275affd>Enviado</option><option value="Entregue" data-v-d275affd>Entregue</option><option value="Cancelado" data-v-d275affd>Cancelado</option>',5)])],40,W)]),l("td",X,p((a=e.createdAt,new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}))),1),l("td",Y,[l("span",{class:x(["px-2 py-1 rounded text-xs",Ge(e.payment.status)])},p(e.payment.method)+" - "+p(e.payment.status),3)]),l("td",Z,[l("button",{onClick:t=>(async e=>{try{const t=await f.getOrder(e.id);Ae.value=t.data}catch(t){console.error("Erro ao carregar detalhes do pedido:",t),De("Erro ao carregar detalhes do pedido","error")}})(e),class:"text-blue-600 hover:text-blue-900 mr-3"}," Ver Detalhes ",8,ee),"Enviado"===e.status?(r(),o("button",{key:0,onClick:t=>(e=>{Be.value=e.id,Le.value=e.trackingCode||"",Oe.value=!0})(e),class:"text-purple-600 hover:text-purple-900 text-xs"}," Rastreamento ",8,te)):d("",!0)])]);var a}),128))])])]),0===Ie.value.length?(r(),o("div",ae," Nenhum pedido encontrado ")):d("",!0)]),Ae.value?(r(),o("div",se,[l("div",oe,[l("div",re,[l("div",le,[l("h3",de," Pedido #"+p(Ae.value.id),1),l("button",{onClick:t[2]||(t[2]=e=>Ae.value=null),class:"text-gray-400 hover:text-gray-600"},[...t[17]||(t[17]=[l("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),l("div",ne,[l("div",ie,[l("div",null,[t[21]||(t[21]=l("h4",{class:"font-medium text-gray-900 mb-2"}," Dados do Cliente ",-1)),l("div",ce,[l("p",null,[t[18]||(t[18]=l("strong",null,"Nome:",-1)),v(" "+p(Ae.value.customer.name),1)]),l("p",null,[t[19]||(t[19]=l("strong",null,"Email:",-1)),v(" "+p(Ae.value.customer.email),1)]),l("p",null,[t[20]||(t[20]=l("strong",null,"Telefone:",-1)),v(" "+p(Ae.value.customer.phone),1)])])]),l("div",null,[t[22]||(t[22]=l("h4",{class:"font-medium text-gray-900 mb-2"}," Endere莽o de Entrega ",-1)),l("div",ue,[l("p",null,p(Ae.value.shipping.address),1),l("p",null,p(Ae.value.shipping.city)+", "+p(Ae.value.shipping.state)+" - "+p(Ae.value.shipping.zipCode),1)])])]),l("div",null,[t[24]||(t[24]=l("h4",{class:"font-medium text-gray-900 mb-3"}," Itens do Pedido ",-1)),l("div",pe,[(r(!0),o(g,null,m(Ae.value.items,e=>(r(),o("div",{key:e.id,class:"flex items-center justify-between border-b pb-3"},[l("div",ge,[l("img",{src:e.image,alt:e.name,class:"w-12 h-12 object-cover rounded"},null,8,me),l("div",null,[l("p",ve,p(e.name),1),l("p",xe," Quantidade: "+p(e.quantity),1)])]),l("span",ye,"R$ "+p(Ue(e.price*e.quantity)),1)]))),128))]),l("div",fe,[l("div",he,[t[23]||(t[23]=l("span",null,"Total:",-1)),l("span",null,"R$ "+p(Ue(Ae.value.total)),1)])])]),l("div",be,[l("div",null,[t[28]||(t[28]=l("h4",{class:"font-medium text-gray-900 mb-2"}," Pagamento ",-1)),l("div",we,[l("p",null,[t[25]||(t[25]=l("strong",null,"M茅todo:",-1)),v(" "+p(Ae.value.payment.method),1)]),l("p",null,[t[26]||(t[26]=l("strong",null,"Status:",-1)),l("span",{class:x(["px-2 py-1 rounded text-xs ml-1",Ge(Ae.value.payment.status)])},p(Ae.value.payment.status),3)]),Ae.value.payment.transactionId?(r(),o("p",ke,[t[27]||(t[27]=l("strong",null,"ID Transa莽茫o:",-1)),v(" "+p(Ae.value.payment.transactionId),1)])):d("",!0)])]),l("div",null,[t[32]||(t[32]=l("h4",{class:"font-medium text-gray-900 mb-2"}," Entrega ",-1)),l("div",Ce,[l("p",null,[t[29]||(t[29]=l("strong",null,"M茅todo:",-1)),v(" "+p(Ae.value.shipping.method),1)]),l("p",null,[t[30]||(t[30]=l("strong",null,"Status:",-1)),v(" "+p(Ae.value.status),1)]),Ae.value.trackingCode?(r(),o("p",Ee,[t[31]||(t[31]=l("strong",null,"C贸digo de Rastreamento:",-1)),v(" "+p(Ae.value.trackingCode),1)])):d("",!0)])])]),l("div",Pe,["Cancelado"!==Ae.value.status&&"Entregue"!==Ae.value.status?(r(),o("button",{key:0,onClick:t[3]||(t[3]=e=>(async e=>{if(confirm("Tem certeza que deseja cancelar este pedido?"))try{await f.deleteOrder(e),await Ve(),De(`Pedido #${e} cancelado com sucesso`,"success")}catch(t){console.error("Erro ao cancelar pedido:",t),De("Erro ao cancelar pedido","error")}})(Ae.value.id)),class:"px-4 py-2 text-red-600 border border-red-600 rounded hover:bg-red-50"}," Cancelar Pedido ")):d("",!0),"Processando"===Ae.value.status?(r(),o("button",{key:1,onClick:t[4]||(t[4]=e=>(async e=>{try{await f.updateOrder(e,{status:"shipped"}),await Ve(),De(`Pedido #${e} marcado como enviado`,"success")}catch(t){console.error("Erro ao marcar como enviado:",t),De("Erro ao atualizar status","error")}})(Ae.value.id)),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," Marcar como Enviado ")):d("",!0),"Enviado"===Ae.value.status?(r(),o("button",{key:2,onClick:t[5]||(t[5]=e=>(async e=>{try{await f.updateOrder(e,{status:"delivered"}),await Ve(),De(`Pedido #${e} marcado como entregue`,"success")}catch(t){console.error("Erro ao marcar como entregue:",t),De("Erro ao atualizar status","error")}})(Ae.value.id)),class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"}," Marcar como Entregue ")):d("",!0)])])])])):d("",!0),Oe.value?(r(),o("div",je,[l("div",Re,[t[34]||(t[34]=l("h3",{class:"text-lg font-semibold mb-4"}," Adicionar C贸digo de Rastreamento ",-1)),l("div",Se,[l("div",null,[t[33]||(t[33]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"C贸digo de Rastreamento",-1)),n(l("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>Le.value=e),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"BR123456789BR"},null,512),[[u,Le.value]])]),l("div",ze,[l("button",{onClick:t[7]||(t[7]=e=>Oe.value=!1),class:"px-4 py-2 text-gray-600 hover:text-gray-800"}," Cancelar "),l("button",{onClick:Fe,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," Salvar ")])])])])):d("",!0)]))}},[["__scopeId","data-v-d275affd"]]);export{De as default};
