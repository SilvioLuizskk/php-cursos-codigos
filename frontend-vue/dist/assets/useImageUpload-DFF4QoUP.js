import{j as e,z as a,D as o}from"./index-klLf_Ke9.js";function r(){const{showNotification:r}=a(),t=e(!1);return{uploading:t,uploadImage:async(e,a="uploads")=>{var n,i,l,d;if(!e)return null;if(!e.type.startsWith("image/"))return r("Por favor, selecione apenas arquivos de imagem.","error"),null;if(e.size>5242880)return r("A imagem deve ter no máximo 5MB.","error"),null;t.value=!0;try{console.log(`Iniciando upload de ${e.name} (${e.size} bytes)`);const t=new FormData;t.append("image",e),t.append("folder",a);const l=await o.post("/upload/image",t,{headers:{"Content-Type":"multipart/form-data"},timeout:3e4});if(console.log("Upload concluído:",l.data),null==(i=null==(n=l.data)?void 0:n.data)?void 0:i.url)return r("Imagem enviada com sucesso!","success"),l.data.data.url;throw new Error("Resposta inválida do servidor")}catch(s){console.error("Erro ao fazer upload da imagem:",s);let e="Erro ao fazer upload da imagem.";return"ECONNABORTED"===s.code?e="Upload cancelado por timeout. Tente novamente.":413===(null==(l=s.response)?void 0:l.status)?e="Imagem muito grande. Máximo 5MB.":422===(null==(d=s.response)?void 0:d.status)&&(e="Formato de imagem inválido."),r(e,"error"),null}finally{t.value=!1}},validateImageUrl:e=>{if(!e)return!0;try{return new URL(e),!0}catch{return!1}}}}export{r as u};
