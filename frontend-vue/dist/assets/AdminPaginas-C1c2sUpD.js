import{k as e,_ as a,r as t,l as s,o as l,c as r,a as o,b as i,d as n,F as u,e as d,t as c,h as g,w as p,v,g as x,u as m,n as b}from"./index-BgbrXe1X.js";const y={getPages:async(a={})=>(await e.get("/pages",{params:a})).data,getPage:async a=>(await e.get(`/pages/${a}`)).data,createPage:async a=>(await e.post("/pages",a)).data,updatePage:async(a,t)=>(await e.put(`/pages/${a}`,t)).data,deletePage:async a=>(await e.delete(`/pages/${a}`)).data,getPageBySlug:async a=>(await e.get(`/pages/slug/${a}`)).data},f={class:"space-y-6"},w={class:"flex justify-between items-center"},h={class:"bg-white rounded-lg shadow overflow-hidden"},P={class:"overflow-x-auto"},k={class:"min-w-full divide-y divide-gray-200"},E={class:"bg-white divide-y divide-gray-200"},C={class:"px-6 py-4 whitespace-nowrap"},S={class:"text-sm font-medium text-gray-900"},j={class:"text-sm text-gray-500"},q={class:"px-6 py-4 whitespace-nowrap"},z={class:"text-sm text-gray-900"},O={class:"px-6 py-4 whitespace-nowrap"},U={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},V={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},N=["onClick"],$=["onClick"],_={key:0,class:"text-center py-8 text-gray-500"},A={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},T={class:"bg-white rounded-lg p-6 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto"},D={class:"text-lg font-semibold mb-4"},L={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},F={class:"text-xs text-gray-500 mt-1"},I={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},R={class:"flex items-center"},B={class:"flex justify-end space-x-3 pt-4"},G=["disabled"],H=a({__name:"AdminPaginas",setup(e){const{showNotification:a}=m(),H=t([]),M=t(!1),J=t(!1),K=t(!1),Q=t(null),W=t({title:"",slug:"",content:"",active:!0,order:1}),X=async()=>{M.value=!0;try{const e=await y.getPages();H.value=e.data||e}catch(e){console.error("Erro ao carregar páginas:",e),a("Erro ao carregar páginas","error")}finally{M.value=!1}};s(()=>W.value.title,e=>{e&&!Q.value&&(W.value.slug=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-"))});const Y=async()=>{console.log("savePage chamado com form:",W.value),J.value=!0;try{if(!W.value.title.trim())return void a("O título da página é obrigatório.","error");if(!W.value.slug.trim())return void a("O slug da página é obrigatório.","error");if(!W.value.content.trim())return void a("O conteúdo da página é obrigatório.","error");if(!/^[a-z0-9-]+$/.test(W.value.slug))return void a("O slug deve conter apenas letras minúsculas, números e hífens.","error");if(H.value.some(e=>{var a;return e.slug===W.value.slug&&e.id!==((null==(a=Q.value)?void 0:a.id)||null)}))return void a("Este slug já está em uso. Escolha outro.","error");Q.value?(console.log("Atualizando página existente:",Q.value.id),await y.updatePage(Q.value.id,W.value),a("Página atualizada com sucesso!","success")):(console.log("Criando nova página"),await y.createPage(W.value),a("Página criada com sucesso!","success")),console.log("Recarregando páginas após salvar..."),await X(),console.log("Páginas recarregadas:",H.value),K.value=!1,W.value={title:"",slug:"",content:"",active:!0,order:H.value.length+1},Q.value=null}catch(e){console.error("Erro ao salvar página:",e);let t="Erro ao salvar página";if(e.response)if(e.response.data&&e.response.data.message)t=e.response.data.message;else if(e.response.data&&e.response.data.errors){t=Object.values(e.response.data.errors).flat().join(", ")}else 422===e.response.status?t="Dados inválidos. Verifique os campos e tente novamente.":500===e.response.status&&(t="Erro interno do servidor. Tente novamente mais tarde.");else e.message&&(t=e.message);a(t,"error")}finally{J.value=!1}};return l(()=>{X()}),(e,t)=>(o(),r("div",f,[i("div",w,[t[7]||(t[7]=i("h1",{class:"text-2xl font-bold text-gray-900"}," Gerenciar Páginas Estáticas ",-1)),i("button",{onClick:t[0]||(t[0]=e=>{K.value=!0,Q.value=null,W.value={title:"",slug:"",content:"",active:!0,order:H.value.length+1}}),class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"}," + Nova Página ")]),i("div",h,[t[9]||(t[9]=i("div",{class:"px-6 py-4 border-b"},[i("h2",{class:"text-lg font-semibold text-gray-900"}," Páginas do Site ")],-1)),i("div",P,[i("table",k,[t[8]||(t[8]=i("thead",{class:"bg-gray-50"},[i("tr",null,[i("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Página "),i("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Slug "),i("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),i("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ordem "),i("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ações ")])],-1)),i("tbody",E,[(o(!0),r(u,null,d(H.value,e=>(o(),r("tr",{key:e.id,class:"hover:bg-gray-50"},[i("td",C,[i("div",S,c(e.title),1),i("div",j,c(e.content.substring(0,50))+"... ",1)]),i("td",q,[i("span",z,"/"+c(e.slug),1)]),i("td",O,[i("span",{class:b(["px-2 py-1 rounded text-xs",e.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},c(e.active?"Ativa":"Inativa"),3)]),i("td",U,c(e.order),1),i("td",V,[i("button",{onClick:a=>(e=>{Q.value=e,W.value={...e},K.value=!0})(e),class:"text-blue-600 hover:text-blue-900 mr-3"}," Editar ",8,N),i("button",{onClick:t=>(async e=>{if(confirm("Tem certeza que deseja excluir esta página? Esta ação não pode ser desfeita."))try{await y.deletePage(e),a("Página excluída com sucesso!","success"),await X()}catch(t){console.error("Erro ao excluir página:",t),a("Erro ao excluir página","error")}})(e.id),class:"text-red-600 hover:text-red-900"}," Excluir ",8,$)])]))),128))])])]),0===H.value.length?(o(),r("div",_," Nenhuma página cadastrada ")):n("",!0)]),K.value?(o(),r("div",A,[i("div",T,[i("h3",D,c(Q.value?"Editar Página":"Nova Página"),1),i("form",{onSubmit:g(Y,["prevent"]),class:"space-y-4"},[i("div",L,[i("div",null,[t[10]||(t[10]=i("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Título da Página",-1)),p(i("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>W.value.title=e),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[v,W.value.title]])]),i("div",null,[t[11]||(t[11]=i("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Slug (URL)",-1)),p(i("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>W.value.slug=e),type:"text",required:"",placeholder:"sobre-nos",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[v,W.value.slug]]),i("p",F," Será acessível em: /"+c(W.value.slug),1)])]),i("div",null,[t[12]||(t[12]=i("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Conteúdo",-1)),p(i("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>W.value.content=e),rows:"12",required:"",placeholder:"Digite o conteúdo da página aqui...",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[v,W.value.content]]),t[13]||(t[13]=i("p",{class:"text-xs text-gray-500 mt-1"}," Suporte a HTML básico e quebras de linha ",-1))]),i("div",I,[i("div",R,[p(i("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>W.value.active=e),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[x,W.value.active]]),t[14]||(t[14]=i("label",{class:"ml-2 block text-sm text-gray-900"},"Página ativa",-1))]),i("div",null,[t[15]||(t[15]=i("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Ordem de exibição",-1)),p(i("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>W.value.order=e),type:"number",min:"1",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[v,W.value.order,void 0,{number:!0}]])])]),i("div",B,[i("button",{type:"button",onClick:t[6]||(t[6]=e=>K.value=!1),class:"px-4 py-2 text-gray-600 hover:text-gray-800"}," Cancelar "),i("button",{type:"submit",disabled:J.value,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"},c(J.value?"Salvando...":"Salvar"),9,G)])],32)])])):n("",!0)]))}},[["__scopeId","data-v-c5294648"]]);export{H as default};
